---
import { MarkdownInstance } from 'astro'

export interface Props {
  post: MarkdownInstance<Record<string, any>>
  words?: number
  maxLength?: number
}

const { post, words = 55, maxLength = 0 } = Astro.props

const postHtml = post.compiledContent()
let txt = postHtml.replace(/<[^>]*>?/gm, '')

if (words > 0) {
  txt = txt.split(' ').slice(0, words).join(' ')
}

if (maxLength > 0) {
  txt = txt.substring(0, maxLength)

  if (txt.length > maxLength) {
    txt += '...'
  }
}
---

<Fragment set:text={txt} />
